---
import AdminLayout from '../../../layouts/AdminLayout.astro';
import TableManager from '../../../admin/TableManager';

export function getStaticPaths() {
    return [
        { params: { table: 'marche' } },
        { params: { table: 'categorie' } },
        { params: { table: 'alimentazioni' } },
        { params: { table: 'cambi' } },
        { params: { table: 'tempi-consegna' } },
    ];
}

const { table } = Astro.params;

// Configuration map: Slug -> { TableName, Title, Fields }
const CONFIG: Record<string, any> = {
    'marche': {
        tableName: 'marche',
        title: 'Gestione Marche',
        fields: [
            { key: 'nome', label: 'Nome Marca', type: 'text' }
        ],
        orderBy: 'nome'
    },
    'categorie': {
        tableName: 'categorie',
        title: 'Gestione Categorie',
        fields: [
            { key: 'nome', label: 'Nome Categoria', type: 'text' }
        ],
        orderBy: 'nome'
    },
    'alimentazioni': {
        tableName: 'alimentazioni',
        title: 'Gestione Alimentazioni',
        fields: [
            { key: 'nome', label: 'Tipo Alimentazione', type: 'text' }
        ],
        orderBy: 'nome'
    },
    'cambi': {
        tableName: 'cambi',
        title: 'Gestione Cambi',
        fields: [
            { key: 'nome', label: 'Tipo Cambio', type: 'text' }
        ],
        orderBy: 'nome'
    },
    'tempi-consegna': {
        tableName: 'tempi_consegna',
        title: 'Gestione Tempi Consegna',
        fields: [
            { key: 'nome', label: 'Tempo Consegna', type: 'text' }
        ],
        orderBy: 'nome'
    }
};

const currentConfig = CONFIG[table || ''] || null;

if (!currentConfig) {
    return Astro.redirect('/404');
}
---

<AdminLayout title={currentConfig.title}>
    <div class="mb-8">
        <h1 class="text-3xl font-extrabold text-gray-900 font-heading">{currentConfig.title}</h1>
        <p class="text-gray-500 mt-2">Aggiungi, modifica o elimina le opzioni disponibili.</p>
    </div>

    <TableManager 
        client:load 
        tableName={currentConfig.tableName}
        title={currentConfig.title}
        fields={currentConfig.fields}
        orderBy={currentConfig.orderBy}
    />
</AdminLayout>
