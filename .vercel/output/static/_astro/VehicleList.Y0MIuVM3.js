import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as o}from"./index.WFquGv8Z.js";import{s as u}from"./supabase.D34_deiT.js";function y({initialVehicles:d}){const[l,c]=o.useState(d),[s,x]=o.useState(""),[a,i]=o.useState(null),m=async r=>{if(confirm("Sei sicuro di voler eliminare questo veicolo? Questa azione non può essere annullata.")){i(r);try{const{error:t}=await u.from("veicoli").delete().eq("id",r);if(t)throw t;c(p=>p.filter(h=>h.id!==r))}catch(t){console.error("Error deleting vehicle:",t),alert("Errore durante l'eliminazione del veicolo.")}finally{i(null)}}},n=l.filter(r=>r.titolo.toLowerCase().includes(s.toLowerCase())||r.marca.toLowerCase().includes(s.toLowerCase())||r.modello.toLowerCase().includes(s.toLowerCase())||r.targa&&r.targa.toLowerCase().includes(s.toLowerCase()));return e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-gray-100 flex flex-col md:flex-row justify-between items-center gap-4",children:[e.jsxs("div",{className:"relative w-full md:w-96",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("svg",{className:"h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z",clipRule:"evenodd"})})}),e.jsx("input",{type:"text",placeholder:"Cerca veicolo per marca, modello o titolo...",className:"pl-10 pr-4 py-2 w-full border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary transition-all text-sm",value:s,onChange:r=>x(r.target.value)})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Totale Veicoli: ",e.jsx("span",{className:"font-bold text-gray-900",children:l.length})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50 border-b border-gray-100 text-xs uppercase tracking-wider text-gray-500 font-semibold",children:[e.jsx("th",{className:"px-6 py-4",children:"Veicolo"}),e.jsx("th",{className:"px-6 py-4",children:"Titolo / Info"}),e.jsx("th",{className:"px-6 py-4",children:"Prezzo"}),e.jsx("th",{className:"px-6 py-4",children:"Tipo"}),e.jsx("th",{className:"px-6 py-4 text-right",children:"Azioni"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:n.length>0?n.map(r=>e.jsxs("tr",{className:"hover:bg-gray-50/50 transition-colors group",children:[e.jsx("td",{className:"px-6 py-4 w-24",children:e.jsx("div",{className:"h-16 w-24 rounded-lg bg-gray-100 overflow-hidden border border-gray-200 relative",children:r.immagine_url?e.jsx("img",{src:r.immagine_url,alt:r.titolo,className:"w-full h-full object-cover"}):e.jsx("div",{className:"flex items-center justify-center h-full text-gray-400",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("image",{x:"1",y:"1",width:"22",height:"22"})})})})}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"font-bold text-gray-900 mb-1",children:r.titolo}),e.jsxs("div",{className:"text-xs text-gray-500 font-medium",children:[r.marca," ",r.modello," ",e.jsx("span",{className:"text-gray-300 mx-1",children:"|"})," ",r.versione]})]}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsxs("div",{className:"font-bold text-primary",children:["€ ",r.canone_mensile||r.noleggio_breve?"Variabile":"0"]}),e.jsx("div",{className:"text-xs text-gray-400",children:"Canone/Mese"})]}),e.jsxs("td",{className:"px-6 py-4",children:[r.noleggio_breve?e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-orange-100 text-orange-800 border border-orange-200",children:"Breve"}):e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-emerald-100 text-emerald-800 border border-emerald-200",children:"Lungo"}),r.promo&&e.jsx("span",{className:"ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800 border border-purple-200",children:"Promo"})]}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-3 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("a",{href:`/admin/veicoli/edit/${r.id}`,className:"p-2 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Modifica",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),e.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]})}),e.jsx("button",{onClick:()=>m(r.id),disabled:a===r.id,className:"p-2 text-gray-500 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50",title:"Elimina",children:a===r.id?e.jsx("div",{className:"animate-spin h-4 w-4 border-2 border-red-600 border-t-transparent rounded-full"}):e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("polyline",{points:"3 6 5 6 21 6"}),e.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}),e.jsx("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),e.jsx("line",{x1:"14",y1:"11",x2:"14",y2:"17"})]})})]})})]},r.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-12 text-center text-gray-400",children:s?"Nessun veicolo trovato per questa ricerca.":"Nessun veicolo presente nel database."})})})]})})]})}export{y as default};
